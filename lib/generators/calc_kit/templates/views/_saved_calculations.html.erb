<%% if saved_calculations&.any? %>
  <div class="mt-6">
    <h3 class="text-sm font-semibold text-gray-500 mb-3">Recent Calculations</h3>
    <div class="space-y-2">
      <%% saved_calculations.each do |calculation| %>
        <div class="rounded-lg border border-gray-200 bg-gray-50 p-3 text-sm dark:bg-zinc-800 dark:border-zinc-700">
          <div class="flex justify-between items-start gap-4">
            <div class="flex-1 min-w-0">
              <div class="text-xs text-gray-400 mb-1">
                <%%= calculation.created_at.to_fs(:short) %>
                <%% if (version_warning = calc_kit_version_warning(calculation)) %>
                  <span class="inline-flex items-center rounded bg-amber-100 px-1.5 py-0.5 text-xs font-medium text-amber-800 dark:bg-amber-900 dark:text-amber-200" title="<%%= version_warning %>">Outdated</span>
                <%% end %>
              </div>
              <div class="flex flex-wrap gap-x-4 gap-y-1">
                <%% calculation.outputs.each do |key, value| %>
                  <span class="text-gray-700 dark:text-gray-300">
                    <span class="text-gray-500"><%%= key.to_s.titleize %>:</span> <%%= value %>
                  </span>
                <%% end %>
              </div>
            </div>
            <%% if defined?(reopen_calculation_path) %>
              <div class="flex gap-2 shrink-0">
                <%%= link_to "Use", reopen_calculation_path(calculation),
                      class: "text-xs text-blue-600 hover:underline" %>
              </div>
            <%% end %>
          </div>
        </div>
      <%% end %>
    </div>
    <%% if defined?(calculations_path) %>
      <%%= link_to "View all", calculations_path, class: "text-xs text-blue-600 hover:underline mt-2 inline-block" %>
    <%% end %>
  </div>
<%% end %>
